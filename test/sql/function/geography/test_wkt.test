# name: test/sql/function/geography/test_wkt.test
# description: Test WKT functions
# group: [geography]

statement ok
PRAGMA enable_verification

# read POINT
query T
SELECT st_from_wkt('point(52.5251 13.1315)')::TEXT;
----
POINT(52.5251 13.1315)

query T
SELECT st_from_wkt('POINT (52.5251 13.1315)')::TEXT;
----
POINT(52.5251 13.1315)

query T
SELECT st_from_wkt('POINT EMPTY')::TEXT;
----
EMPTY

# read LINESTRING
query T
SELECT st_from_wkt('LINESTRING (13.3450 52.5266, 13.3472 52.5175, 13.3364 52.5110, 12.9442 52.3772)')::TEXT;
----
LINESTRING(13.345 52.5266, 13.3472 52.5175, 13.3364 52.511, 12.9442 52.3772)

# read POLYGON
query T
SELECT st_from_wkt('POLYGON ((13.4402 52.5393, 13.3618 52.5484, 13.2553 52.5066, 13.3907 52.4605, 13.4823 52.5019))')::TEXT;
----
POLYGON((13.4402 52.5393, 13.3618 52.5484, 13.2553 52.5066, 13.3907 52.4605, 13.4823 52.5019))

query T
SELECT st_from_wkt('POLYGON ((13.4402 52.5393, 13.3618 52.5484, 13.2553 52.5066, 13.3907 52.4605, 13.4823 52.5019),
                             (13.3497 52.5195,  13.3429 52.5176,  13.3495 52.5154,  13.3537 52.5176))')::TEXT;
----
POLYGON((13.4402 52.5393, 13.3618 52.5484, 13.2553 52.5066, 13.3907 52.4605, 13.4823 52.5019), (13.3497 52.5195, 13.3429 52.5176, 13.3495 52.5154, 13.3537 52.5176))

# read MULTIPOINT
query T
SELECT st_from_wkt('MULTIPOINT ((52 38), (53 37), (54 36), (55 35))')::TEXT;
----
MULTIPOINT((52 38), (53 37), (54 36), (55 35))

# read MULTILINESTRING
query T
SELECT st_from_wkt('MULTILINESTRING ((10 110, 20 120, 10 140), (40 240, 30 230, 40 220, 30 210))')::TEXT;
----
MULTILINESTRING((10 110, 20 120, 10 140), (40 240, 30 230, 40 220, 30 210))

# read MULTIPOLYGON
query T
SELECT st_from_wkt('MULTIPOLYGON (((40 140, 20 145, 45 130, 40 140)),
                                  ((220 235, 210 230, 210 210, 230 225, 245 220, 220 235),
                                   (30 320, 20 315, 20 325, 30 320)))')::TEXT;
----
MULTIPOLYGON(((40 140, 20 145, 45 130, 40 140)), ((220 235, 210 230, 210 210, 230 225, 245 220, 220 235), (30 320, 20 315, 20 325, 30 320)))

query T
SELECT st_from_wkt('MULTIPOLYGON (((-73.9845 40.7202, -73.9851 40.7191, -73.9859 40.7193,
                                    -73.9868 40.7196, -73.9874 40.7184)))')::TEXT;
----
MULTIPOLYGON(((-73.9845 40.7202, -73.9851 40.7191, -73.9859 40.7193, -73.9868 40.7196, -73.9874 40.7184)))

# read GEOMETRYCOLLECTION
query T
SELECT st_from_wkt('GEOMETRYCOLLECTION
                        (MULTIPOLYGON (((140 40, 120 45, 145 30, 140 40)),
                          ((120 35, 110 30, 110 10, 130 5, 145 20, 120 35), (130 20, 120 15, 120 25, 130 20))),
                        MULTIPOINT ((10 340), (40 330), (20 320), (30 310)),
                        MULTIPOLYGON (((540 40, 520 45, 545 30, 540 40)),
                          ((540 40, 520 45)),
                          ((510 10, 530 5, 545 20, 520 35), (530 20, 520 15, 520 25, 530 20),(310 10, 330 5, 345 20, 320 35))),
                        MULTIPOLYGON (((40 40, 20 45, 45 30, 40 40)),
                          ((20 35, 10 30, 10 10, 30 5, 45 20, 20 35), (30 20, 20 15, 20 25), (10 20, 30 40))),
                        MULTILINESTRING ((10 10, 20 20, 10 40), (40 40, 30 30, 40 20, 30 10)),
                        POINT (30 10),
                        POLYGON ((130 710, 140 740, 120 340, 510 520)))')::TEXT;
----
GEOMETRYCOLLECTION(MULTIPOLYGON(((140 40, 120 45, 145 30, 140 40)), ((120 35, 110 30, 110 10, 130 5, 145 20, 120 35), (130 20, 120 15, 120 25, 130 20))), MULTIPOINT((10 340), (40 330), (20 320), (30 310)), MULTIPOLYGON(((540 40, 520 45, 545 30, 540 40)), ((540 40, 520 45)), ((510 10, 530 5, 545 20, 520 35), (530 20, 520 15, 520 25, 530 20), (310 10, 330 5, 345 20, 320 35))), MULTIPOLYGON(((40 40, 20 45, 45 30, 40 40)), ((20 35, 10 30, 10 10, 30 5, 45 20, 20 35), (30 20, 20 15, 20 25), (10 20, 30 40))), MULTILINESTRING((10 10, 20 20, 10 40), (40 40, 30 30, 40 20, 30 10)), POINT(30 10), POLYGON((130 710, 140 740, 120 340, 510 520)))

